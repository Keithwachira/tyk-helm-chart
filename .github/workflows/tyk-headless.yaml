name: Tyk Headless Push Helm
on: push
defaults:
  run:
    working-directory: ./tyk-headless
jobs:
  push:
    name: Tyk Headless Push CS
    runs-on: ubuntu-latest
    branches:
      - main
      - release-**
    paths:
      - 'tyk-headless/**'
    steps:
      - uses: actions/checkout@v2
      - name: Push
        id: push
        uses: cloudsmith-io/action@master
        with:
          api-key: ${{ secrets.CLOUDSMITH_API_KEY }}
          command: 'push'
          format: 'helm'
          owner: 'tyk'
          repo: 'tyk-headless'
          version: ${{ github.sha }}
          file: 'test/fixture/tyk-headless-helm-chart-v0.0.1.tar.gz'